{% extends "layout.html" %}
{% set title = 'Communication' %}
{% block pageTitle %}{{ title }}{% endblock %}

{% block content %}

{% include "case/_case-service-user-banner.html" %}

{% set currentNavSection = 'timeline' %}
{% include "case/_case-nav.html" %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <h1 class="govuk-heading-l govuk-!-margin-bottom-7">{{ title }}</h1>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    {% set hr = joiner('<hr>') %}
    {% for entry in communicationEntries(CRN, data) %}

      {{ hr() | safe }}

      {% if entry.type === 'Appointment' %}
        {% include "case/_appointment-timeline-entry.html" %}
      {% elseif entry.type === 'Text message' or entry.type === 'Email' %}
        {% include "case/_communcation-timeline-entry.html" %}
      {% endif %}

      <p class="govuk-body-s govuk-hint-s">Last updated by {{ entry.lastUpdatedBy }} on {{ entry.timestamp | dateWithYear }} at {{ entry.timestamp | govukTimeWithMinutes }}</p>
    {% endfor %}
  </div>
</div>

{% endblock %}
